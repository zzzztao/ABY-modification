# 三元组效率测试

1000组32位三元组生成测试：

|                        | OT         | paillier   | ourwork   |
| ---------------------- | ---------- | ---------- | --------- |
| Timings（ms）          | 61.699     | 8433       | 17.017    |
| Communication（bytes） | 640060 * 2 | 782977 * 2 | 24090 * 2 |

1000组64位三元组生成测试：

|                        | OT          | paillier   | ourwork   |
| ---------------------- | ----------- | ---------- | --------- |
| Timings（ms）          | 139.471     | 8072.64    | 38.544    |
| Communication（bytes） | 1536068 * 2 | 790676 * 2 | 48090 * 2 |

备注：1. 时间仅供参考，计算机配置、子系统、虚拟机、直装linux，效率会差别很大。



# 牛顿迭代法效率测试与分析：

32位除法

|                                       | 自带小数除法           | 牛顿迭代3次（8位精度）   |
| ------------------------------------- | ---------------------- | ------------------------ |
| Timings（ms）= Setup +Online          | 825 = 345 + 480        | 1200 = 276 +924          |
| Communication（bytes）= Setup +Online | 180059 = 175759 + 4300 | 645493 =  631622 + 13871 |


|                                       | 牛顿迭代1次（2位精度） | 牛顿迭代0次（初始化除法） |
| ------------------------------------- | ---------------------- | ------------------------- |
| Timings（ms）= Setup +Online          | 745 = 259 + 486        | 520= 261+259              |
| Communication（bytes）= Setup +Online | 319835 = 312863 + 6972 | 200981=  197446+ 3535     |

备注：时间仅供参考，配置、子系统、虚拟机、直装linux，效率会差别很大。

1. 初始化除法，主要是指找迭代开始的x0。

2. 每次迭代进行的是2次小数乘法和1次小数减法。
3. 小数的乘法和减法会大幅度增加在线计算时间，和初始化交互数据量。
4. 一般处理小数办法就是放大变成整数，然后放到算数电路里去。（此方案不行）



# 指数e^x效率测试与分析

|                                       | 自带小数指数（32位）    | float ourwork（32位）     |
| ------------------------------------- | ----------------------- | ------------------------- |
| Timings（ms）= Setup +Online          | 454 = 247 + 207         | 1431 = 359 + 1093         |
| Communication（bytes）= Setup +Online | 254840 = 250703 +  4137 | 1833610 = 1801074 + 32536 |

1. 效率差别比较大。

   分析原因：1. 每次32位指数计算都会使用29次/21次（小数有整数位，小数没整数位）选择器。

   ​			 		2. 每次32位指数计算都会使用28次/20次 （小数有整数位，小数没整数位）小数乘法。

2. 优化思路：

   1. 设计新的算法避免选择器的使用。
      $$
      x*基底+（1-x）*1
      $$
      用小数乘法代替选择器，效率不确定 因为小数乘法也费通信和时间。

   2. 将乘法全部转换到算术电路中去做。
   
      ​	可以大大降低Setup+Online数据交换，不使用小数乘法效率也会提升。



# 反思ABY方案：

ABY指数为啥会和ourwork差距会这么大？到底是哪有问题？

所以我测了程序运行时间：

|               | 自带小数指数（32位） | float ourwork（32位） |
| ------------- | -------------------- | --------------------- |
| Timings（ms） | 1003.1               | 2546.5                |

用学校实验室i5 liunx机器跑：
|               | 自带小数指数（32位） | float ourwork（32位） |
| ------------- | -------------------- | --------------------- |
| Timings（ms） | 170～180             | 280～290              |

这样对比起来，效率可以接受。

ABY计时规则还是有猫腻的。



# 近期任务规划：

1. 优化指数方案

2. 封装sigmoid，softmax，tanh，relu。

3. 和刘老师沟通后，现在方案实现更多是实验。后续可能会移植spdz。

   ​	spdz的优点：1.支持多方&两方。2.支持诚实&恶意 