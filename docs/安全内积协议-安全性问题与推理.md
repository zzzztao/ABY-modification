# 7/27安全内积协议-安全问题与推理

$$
P_0:a_0,b_0;\\
P_1:a_1,b_1,c_1;\\
P_0想获得c_0 = (a_0+a_1)(b_0+b_1)-c_1\\
    =a_0b_0+a_0b_1+a_1b_0+a_1b_1-c_1\\
    =(1,b_0,a_0,a_0b_0,-1)(a_1b_1,a_1,b_1,1,c_1)
$$



1. P0初始化向量：
   $$
   X = (1,b_0,a_0,a_0b_0,-1) \\
   R = (r_1,r_2,r_3,r_4,r_5) \quad\ r_i ∈F_p \\
   Z = X – R =(1 - r_1, b_0 - r_2,a_0 - r_3,a_0b_0 - r_4,-1 - r_5) =( z_1, z_2, …, z_5 ),z_i = x_i - r_i∈F_p \\
   random \quad\ r \quad\ (r^{-1}，r∈F_p)\\
   W = r*Z = （r*z_1, r*z_2, …, r*z_n）,w_i = r*z_i∈Fp
   $$

2. P0->P1  发送向量R与W。

3. P1初始化向量：
   $$
   Y = (a_1b_1,a_1,b_1,1,c_1)
   $$

4. P1根据接收到的R，W计算值u，v：
   $$
   u = R · Y = (r_1*a_1b_1 + r_2*a_1+r_3*b_1+r_4*1+r_5*c_1) \quad\ u∈Fp \\
   v = W · Y = (w_1*a_1b_1 + w_2*a_1+w_3*b_1+w_4*1+w_5*c_1) \quad\ v∈Fp \\
   $$

5. P1 -> P0发送值u与v。

6. P0计算c0：
   $$
   c_0 = u + r^{-1}v \quad\ c_0∈Fp
   $$


协议结束后：P0拥有值a0, b0, c0 , u, v, 随机值r, 向量X，R，W，

协议结束后:  P0不会知道a1，b1，c1

P0可用已知参数列关于a1，b1，c1方程：
$$
u = R · Y = (r_1*a_1b_1 + r_2*a_1+r_3*b_1+r_4*1+r_5*c_1)\\
v = W · Y = (w_1*a_1b_1 + w_2*a_1+w_3*b_1+w_4*1+w_5*c_1)\\
按照算三元组性质：(c_0+c_1) = (a_0+a_1)(b_0+b_1)
$$
问题！！！有三个方程是不是就可以解开三个未知数a1，b1，c1

三个方程 整理后为
$$
u = R · Y = (r_1*a_1b_1 + r_2*a_1+r_3*b_1+r_4*1+r_5*c_1)\\
v = W · Y = (w_1*a_1b_1 + w_2*a_1+w_3*b_1+w_4*1+w_5*c_1)\\
c_0 =X·Y = (1,b_0,a_0,a_0b_0,-1)(a_1b_1,a_1,b_1,1,c_1)
$$
继续整理：
$$
u = R · Y = (r_1*a_1b_1 + r_2*a_1+r_3*b_1+r_4*1+r_5*c_1) \quad\ (EQ.1)\\ 
c_0 =X·Y = (1,b_0,a_0,a_0b_0,-1)(a_1b_1,a_1,b_1,1,c_1)\quad\ (EQ.2)\\
v = W · Y = (r*Z)·Y = (r*(X-R))·Y = r *(X·Y - R·Y)\quad\ (EQ.3)\\
$$
EQ.3可用EQ.2与EQ.1线性表示 则该三个方程无法解出三个未知数a1，b1，c1

虽然无法解出三个未知数，但是可以确认任意俩个未知数的线性关系。